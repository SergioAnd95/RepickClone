;'use strict';(function($){if(typeof(String.prototype.trim)==="undefined"){String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,'');};}
$.fn.endlessPaginate=function(options){var defaults={containerSelector:'.endless_container',loadingSelector:'.endless_loading',moreSelector:'a.endless_more',pageSelector:'.endless_page_template',pagesSelector:'a.endless_page_link',onClick:function(){},onCompleted:function(){},paginateOnScroll:false,paginateOnScrollMargin:1,paginateOnScrollChunkSize:0},settings=$.extend(defaults,options);var getContext=function(link){return{key:link.data("el-querystring-key").split(' ')[0],url:link.attr('href')};};return this.each(function(){var element=$(this),loadedPages=1;element.on('click',settings.moreSelector,function(){var link=$(this),html_link=link.get(0),container=link.closest(settings.containerSelector),loading=container.find(settings.loadingSelector);if(loading.is(':visible')){return false;}
link.hide();loading.show();var context=getContext(link);if(settings.onClick.apply(html_link,[context])!==false){var data='querystring_key='+context.key;$.get(context.url,data,function(fragment){container.before(fragment);container.remove();loadedPages+=1;settings.onCompleted.apply(html_link,[context,fragment.trim()]);});}
return false;});if(settings.paginateOnScroll){var win=$(window),doc=$(document);doc.scroll(function(){if(doc.height()-win.height()-
win.scrollTop()<=settings.paginateOnScrollMargin){var chunckSize=settings.paginateOnScrollChunkSize;if(!chunckSize||loadedPages%chunckSize){element.find(settings.moreSelector).click();}else{element.find(settings.moreSelector).addClass('endless_chunk_complete');}}});}
element.on('click',settings.pagesSelector,function(){var link=$(this),html_link=link.get(0),context=getContext(link);if(settings.onClick.apply(html_link,[context])!==false){var page_template=link.closest(settings.pageSelector),data='querystring_key='+context.key;page_template.load(context.url,data,function(fragment){settings.onCompleted.apply(html_link,[context,fragment.trim()]);});}
return false;});});};$.endlessPaginate=function(options){return $('body').endlessPaginate(options);};})(jQuery);;$.endlessPaginate({paginateOnScroll:true,paginateOnScrollMargin:200});